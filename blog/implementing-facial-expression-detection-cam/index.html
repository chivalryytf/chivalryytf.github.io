<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Implementing Live Facial Expression Detection on Web Browser using open-source Face-Api - chivalryytf.me</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="charset" charset="utf-8"><meta data-n-head="ssr" data-hid="mobile-web-app-capable" name="mobile-web-app-capable" content="yes"><meta data-n-head="ssr" data-hid="apple-mobile-web-app-title" name="apple-mobile-web-app-title" content="Prashant Shrestha - Codeok"><meta data-n-head="ssr" data-hid="author" name="author" content="Prashant Shrestha"><meta data-n-head="ssr" data-hid="og:type" name="og:type" property="og:type" content="website"><meta data-n-head="ssr" data-hid="og:site_name" name="og:site_name" property="og:site_name" content="Prashant Shrestha - Codeok"><meta data-n-head="ssr" data-hid="twitter:site" name="twitter:site" property="twitter:site" content="@chivalryytf"><meta data-n-head="ssr" data-hid="twitter:creator" name="twitter:creator" property="twitter:creator" content="@chivalryytf"><meta data-n-head="ssr" data-hid="og:url" name="og:url" property="og:url" content="https://chivalryytf.me/blog/implementing-facial-expression-detection-cam"><meta data-n-head="ssr" data-hid="og:title" name="og:title" property="og:title" content="Implementing Live Facial Expression Detection on Web Browser using open-source Face-Api - chivalryytf.me"><meta data-n-head="ssr" data-hid="description" name="description" content="How to implement live facial expression detection on a web browser."><meta data-n-head="ssr" data-hid="og:description" name="og:description" property="og:description" content="How to implement live facial expression detection on a web browser."><meta data-n-head="ssr" data-hid="og:image" name="og:image" property="og:image" content="https://firebasestorage.googleapis.com/v0/b/chivalryytf-e6a04.appspot.com/o/blogs%2Fimplementing-facial-expression-detection-cam%2Fface-rec-me-min.png?alt=media&token=7e86e97d-2c9f-4b54-b3ff-af173edbb92f"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="preconnect" href="https://fonts.gstatic.com"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,400;0,700;1,400;1,700&display=swap"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&display=swap"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&display=swap"><link data-n-head="ssr" rel="shortcut icon" href="/_nuxt/icons/icon_64x64.9521ea.png"><link data-n-head="ssr" rel="apple-touch-icon" href="/_nuxt/icons/icon_512x512.9521ea.png" sizes="512x512"><link data-n-head="ssr" rel="manifest" href="/_nuxt/manifest.1c5e4b56.json" data-hid="manifest"><link data-n-head="ssr" rel="canonical" href="https://chivalryytf.me/blog/implementing-facial-expression-detection-cam"><script data-n-head="ssr" type="application/ld+json">{"@type":"Article","datePublished":"2020-03-15T08:30:27.601Z","dateModified":"2020-03-15T09:52:47.539Z","headline":"Implementing Live Facial Expression Detection on Web Browser using open-source Face-Api","image":{"image":"https://firebasestorage.googleapis.com/v0/b/chivalryytf-e6a04.appspot.com/o/blogs%2Fimplementing-facial-expression-detection-cam%2Fface-rec-me-min.png?alt=media&amp;token=7e86e97d-2c9f-4b54-b3ff-af173edbb92f","alt":"Optimizing and Resizing Images Using Canvas API cover image","caption":"Photo by Arsen","thumb":"https://firebasestorage.googleapis.com/v0/b/chivalryytf-e6a04.appspot.com/o/blogs%2Fimplementing-facial-expression-detection-cam%2Fface-rec-me-min%20(1).png?alt=media&amp;token=eec3127c-e54f-49b4-b351-8be09e7d2247"}}</script><link rel="preload" href="/_nuxt/c4e5260.js" as="script"><link rel="preload" href="/_nuxt/ee1435b.js" as="script"><link rel="preload" href="/_nuxt/e730602.js" as="script"><link rel="preload" href="/_nuxt/2b20522.js" as="script"><link rel="preload" href="/_nuxt/caea6eb.js" as="script"><style data-vue-ssr-id="0211d3d2:0 5a159abf:0 1b4296a6:0 fa7ff0ca:0 5c2eaa1a:0">/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}button{background-color:transparent;background-image:none}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}html{font-family:Source Sans Pro,sans-serif;line-height:1.5}*,:after,:before{box-sizing:border-box;border:0 solid #e2e8f0}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#a0aec0}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#a0aec0}input::placeholder,textarea::placeholder{color:#a0aec0}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit}code,kbd,pre,samp{font-family:Inconsolata,monospace}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}.space-x-4>:not(template)~:not(template){--space-x-reverse:0;margin-right:calc(1rem*var(--space-x-reverse));margin-left:calc(1rem*(1 - var(--space-x-reverse)))}.appearance-none{-webkit-appearance:none;-moz-appearance:none;appearance:none}.bg-white{--bg-opacity:1;background-color:#fff;background-color:rgba(255,255,255,var(--bg-opacity))}.bg-gray-100{--bg-opacity:1;background-color:#f7fafc;background-color:rgba(247,250,252,var(--bg-opacity))}.hover\:bg-gray-200:hover{--bg-opacity:1;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity))}.border-transparent{border-color:transparent}.border-gray-200{--border-opacity:1;border-color:#edf2f7;border-color:rgba(237,242,247,var(--border-opacity))}.rounded{border-radius:.25rem}.rounded-t{border-top-left-radius:.25rem;border-top-right-radius:.25rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.table{display:table}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.flex-grow{flex-grow:1}.font-serif{font-family:Libre Baskerville,serif}.font-mono{font-family:Inconsolata,monospace}.font-bold{font-weight:700}.h-5{height:1.25rem}.h-6{height:1.5rem}.h-auto{height:auto}.text-xs{font-size:.75rem}.text-sm{font-size:.875rem}.text-2xl{font-size:1.5rem}.leading-normal{line-height:1.5}.list-none{list-style-type:none}.my-4{margin-top:1rem;margin-bottom:1rem}.my-8{margin-top:2rem;margin-bottom:2rem}.mx-auto{margin-left:auto;margin-right:auto}.mt-1{margin-top:.25rem}.mr-2{margin-right:.5rem}.ml-2{margin-left:.5rem}.mb-4{margin-bottom:1rem}.ml-5{margin-left:1.25rem}.mb-8{margin-bottom:2rem}.mt-16{margin-top:4rem}.max-w-screen-md{max-width:768px}.min-h-screen{min-height:100vh}.object-contain{-o-object-fit:contain;object-fit:contain}.object-cover{-o-object-fit:cover;object-fit:cover}.outline-none{outline:2px solid transparent;outline-offset:2px}.p-4{padding:1rem}.px-0{padding-left:0;padding-right:0}.py-2{padding-top:.5rem;padding-bottom:.5rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.pl-1{padding-left:.25rem}.pb-2{padding-bottom:.5rem}.pl-3{padding-left:.75rem}.pr-4{padding-right:1rem}.pb-8{padding-bottom:2rem}.pl-10{padding-left:2.5rem}.pt-32{padding-top:8rem}.placeholder-gray-600::-moz-placeholder{--placeholder-opacity:1;color:#718096;color:rgba(113,128,150,var(--placeholder-opacity))}.placeholder-gray-600:-ms-input-placeholder{--placeholder-opacity:1;color:#718096;color:rgba(113,128,150,var(--placeholder-opacity))}.placeholder-gray-600::placeholder{--placeholder-opacity:1;color:#718096;color:rgba(113,128,150,var(--placeholder-opacity))}.pointer-events-none{pointer-events:none}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-y-0{top:0;bottom:0}.right-0{right:0}.left-0{left:0}.shadow-sm{box-shadow:0 1px 2px 0 rgba(0,0,0,.05)}.shadow{box-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px 0 rgba(0,0,0,.06)}.shadow-lg{box-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.05)}.fill-current{fill:currentColor}.text-gray-600{--text-opacity:1;color:#718096;color:rgba(113,128,150,var(--text-opacity))}.text-gray-700{--text-opacity:1;color:#4a5568;color:rgba(74,85,104,var(--text-opacity))}.hover\:text-gray-800:hover,.text-gray-800{--text-opacity:1;color:#2d3748;color:rgba(45,55,72,var(--text-opacity))}.uppercase{text-transform:uppercase}.no-underline{text-decoration:none}.w-0{width:0}.w-5{width:1.25rem}.w-6{width:1.5rem}.w-8{width:2rem}.w-full{width:100%}.z-10{z-index:10}.z-50{z-index:50}.transition-colors{transition-property:background-color,border-color,color,fill,stroke}.ease-linear{transition-timing-function:linear}.duration-300{transition-duration:.3s}@-webkit-keyframes spin{to{transform:rotate(1turn)}}@keyframes spin{to{transform:rotate(1turn)}}@-webkit-keyframes ping{75%,to{transform:scale(2);opacity:0}}@keyframes ping{75%,to{transform:scale(2);opacity:0}}@-webkit-keyframes pulse{50%{opacity:.5}}@keyframes pulse{50%{opacity:.5}}@-webkit-keyframes bounce{0%,to{transform:translateY(-25%);-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1)}}@keyframes bounce{0%,to{transform:translateY(-25%);-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1)}}@media (min-width:640px){.sm\:container{width:100%}}@media (min-width:640px) and (min-width:640px){.sm\:container{max-width:640px}}@media (min-width:640px) and (min-width:768px){.sm\:container{max-width:768px}}@media (min-width:640px) and (min-width:1024px){.sm\:container{max-width:1024px}}@media (min-width:640px) and (min-width:1280px){.sm\:container{max-width:1280px}}@media (min-width:640px){.sm\:bg-gray-200{--bg-opacity:1;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity))}.sm\:rounded-none{border-radius:0}.sm\:flex{display:flex}.sm\:flex-row-reverse{flex-direction:row-reverse}.sm\:justify-between{justify-content:space-between}.sm\:flex-shrink-0{flex-shrink:0}.sm\:ml-4{margin-left:1rem}.sm\:p-0{padding:0}.sm\:p-4{padding:1rem}.sm\:px-0{padding-left:0;padding-right:0}.sm\:pr-4{padding-right:1rem}.sm\:pl-10{padding-left:2.5rem}.sm\:relative{position:relative}.sm\:w-1\/3{width:33.333333%}.sm\:w-1\/4{width:25%}.sm\:w-full{width:100%}}@media (min-width:768px){.md\:container{width:100%}}@media (min-width:768px) and (min-width:640px){.md\:container{max-width:640px}}@media (min-width:768px) and (min-width:768px){.md\:container{max-width:768px}}@media (min-width:768px) and (min-width:1024px){.md\:container{max-width:1024px}}@media (min-width:768px) and (min-width:1280px){.md\:container{max-width:1280px}}@media (min-width:1024px){.lg\:container{width:100%}}@media (min-width:1024px) and (min-width:640px){.lg\:container{max-width:640px}}@media (min-width:1024px) and (min-width:768px){.lg\:container{max-width:768px}}@media (min-width:1024px) and (min-width:1024px){.lg\:container{max-width:1024px}}@media (min-width:1024px) and (min-width:1280px){.lg\:container{max-width:1280px}}@media (min-width:1024px){.lg\:justify-around{justify-content:space-around}}@media (min-width:1280px){.xl\:container{width:100%}}@media (min-width:1280px) and (min-width:640px){.xl\:container{max-width:640px}}@media (min-width:1280px) and (min-width:768px){.xl\:container{max-width:768px}}@media (min-width:1280px) and (min-width:1024px){.xl\:container{max-width:1024px}}@media (min-width:1280px) and (min-width:1280px){.xl\:container{max-width:1280px}}body{--text-opacity:1;color:#2d3748;color:rgba(45,55,72,var(--text-opacity));font-size:1.125rem}h1{font-size:2.25rem;font-family:Libre Baskerville,serif}h2{font-size:1.5rem}a{color:#4299e1;color:rgba(66,153,225,var(--text-opacity));text-decoration:underline}a,a:hover{--text-opacity:1}a:hover{color:#2b6cb0;color:rgba(43,108,176,var(--text-opacity))}ol,p,ul{margin-bottom:1rem}ol,ul{padding-left:2rem;margin-top:1rem}ul{list-style-type:disc}ol{list-style-type:decimal}li>ol,li>p,li>ul{margin:0}blockquote{border-left-width:4px;--border-opacity:1;border-color:#718096;border-color:rgba(113,128,150,var(--border-opacity));font-style:italic;padding-left:1rem}figure img{width:100%}figcaption{font-size:.875rem;--text-opacity:1;color:#718096;color:rgba(113,128,150,var(--text-opacity));text-align:center}p code{display:inline-block;font-weight:700}.nuxt-content-highlight{margin-bottom:1rem;position:relative}.nuxt-content-highlight .filename{position:absolute;right:0;--text-opacity:1;color:#718096;color:rgba(113,128,150,var(--text-opacity));z-index:10;margin-right:.5rem;margin-top:.5rem;font-size:.875rem}.nuxt-content h1,.nuxt-content h2{font-family:Source Sans Pro,sans-serif;font-size:2.25rem;margin-bottom:.5rem}.nuxt-content h3{font-size:1.875rem;margin-bottom:.5rem}.nuxt-content h4{font-size:1.5rem;margin-bottom:.5rem}.nuxt-content img{margin-left:auto;margin-right:auto;width:100%}code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:0 0;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8292a2}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#00f;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}.search-box--focus[data-v-3b9193e8],.search-box[data-v-3b9193e8]:focus{width:100%;padding-left:2.5rem;padding-right:1rem;--bg-opacity:1;background-color:#fff;background-color:rgba(255,255,255,var(--bg-opacity));box-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px 0 rgba(0,0,0,.06);border-width:1px;--border-opacity:1;border-color:#edf2f7;border-color:rgba(237,242,247,var(--border-opacity))}.search-results[data-v-3b9193e8]{top:-5px}</style><link rel="preload" href="/_nuxt/static/1616000276/blog/implementing-facial-expression-detection-cam/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1616000276/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div class="flex flex-col min-h-screen"><header class="p-4 border-b shadow-sm fixed w-full z-10 bg-white flex items-center sm:justify-between lg:justify-around"><a href="/" class="font-mono font-bold text-2xl text-gray-800 no-underline hover:text-gray-800 nuxt-link-active"><span><img src="/icon.png" class="inline w-8 object-contain"> chivalryytf.me</span></a> <div class="absolute right-0 px-4 sm:relative sm:px-0 sm:w-1/3 sm:relative" data-v-3b9193e8><div class="w-full" data-v-3b9193e8><input type="search" autocomplete="off" placeholder="Search" class="search-box border border-transparent text-gray-700 placeholder-gray-600 rounded py-2 px-5 block w-0 appearance-none leading-normal outline-none sm:w-full sm:pl-10 sm:pr-4 sm:bg-gray-200" data-v-3b9193e8> <div class="px-4 relative" data-v-3b9193e8><!----></div></div> <div class="pointer-events-none absolute inset-y-0 pl-3 flex items-center" data-v-3b9193e8><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="search-icon fill-current pointer-events-none text-gray-600 w-5 h-5" data-v-3b9193e8><path d="M12.9 14.32a8 8 0 1 1 1.41-1.41l5.35 5.33-1.42 1.42-5.33-5.34zM8 14A6 6 0 1 0 8 2a6 6 0 0 0 0 12z" data-v-3b9193e8></path></svg></div></div></header> <main class="flex-grow pt-32 pb-8 px-4 max-w-screen-md mx-auto w-full"><article><div class="uppercase text-xs font-bold text-gray-600"><div class="mr-2 inline-block">
      Canvas API
    </div><div class="mr-2 inline-block">
      Cloud Storage
    </div><div class="mr-2 inline-block">
      Firebase
    </div><div class="mr-2 inline-block">
      Nuxt
    </div></div> <h1>
    Implementing Live Facial Expression Detection on Web Browser using open-source Face-Api
  </h1> <h2 class="text-gray-700">
    The open-source Face-api javascript module provides a real-time facial detection functions that can be used for live facial detection on web
  </h2> <div class="text-sm text-gray-600">
    March 15, 2020
  </div> <figure class="my-4"><img src="https://firebasestorage.googleapis.com/v0/b/chivalryytf-e6a04.appspot.com/o/blogs%2Fimplementing-facial-expression-detection-cam%2Fface-rec-me-min.png?alt=media&token=7e86e97d-2c9f-4b54-b3ff-af173edbb92f" alt="Optimizing and Resizing Images Using Canvas API cover image"> <figcaption>Photo by Arsen</figcaption></figure> <nav><ul class="px-4 my-4"><li class="pb-2 pl-1"><a href="/blog/implementing-facial-expression-detection-cam#face-api" class="no-underline">
          Face API
        </a></li><li class="pb-2 pl-1"><a href="/blog/implementing-facial-expression-detection-cam#frontend-view---file-element" class="no-underline">
          Frontend View - File element
        </a></li><li class="pb-2 pl-1"><a href="/blog/implementing-facial-expression-detection-cam#application---the-script" class="no-underline">
          Application - The Script
        </a></li><li class="pb-2 pl-1"><a href="/blog/implementing-facial-expression-detection-cam#live-demonstration" class="no-underline">
          Live Demonstration
        </a></li></ul></nav> <div class="my-8 nuxt-content"><h2 id="face-api"><a href="#face-api" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Face API</h2>
<p>Face-api.js is a JavaScript module, built on top of tensorflow.js core. It implements several
Convolutional Neural Networks (CNNs) to perform face detections and face recognition. It has been
optimized to work on web and mobile devices.</p>
<p>More examples and full API documentation can be found at
<a href="https://justadudewhohacks.github.io/face-api.js/docs/globals.html" rel="nofollow noopener noreferrer" target="_blank">https://justadudewhohacks.github.io/face-api.js/docs/globals.html</a></p>
<p>This api provies various global neural network instances.
However, in this application, we shall use only three of them.</p>
<p><strong>1. Tiny Face Detector</strong>
Tiny Face Detector is an optimized face detector model implemented by face recognition api. The detector computes the locations of each face in an image and will return the bounding boxes together with it's probability for each face. This detector uses depthwise separable convolutions instead of regular convolutions, which makes it much faster than the other detectors in the api like SSD MobileNet V1. However, it is slightly less accurate.</p>
<p><strong>2. Face Landmark 68 Net</strong>
This model predicts the 68 specific facial landmarks for each detected face. You can learn more about 68 facial landmarks from this paper:
<a href="https://www.researchgate.net/figure/68-facial-landmarks_fig1_338048224" rel="nofollow noopener noreferrer" target="_blank">https://www.researchgate.net/figure/68-facial-landmarks_fig1_338048224</a>.
68 facial landmarks are basically the 68 points on a human face whose relative position can help determine if two faces belong to the same person or not.
It employs the ideas of depthwise separable convolutions as well as densely connected blocks.</p>
<p><strong>3. Face Expression Net</strong>
As the name suggests, this model is used to categorize the expression of the person's face in one of the seven facial expression categories viz. neutral, happy, sad, angry, fearful, disgusted, surprised. It is lightweight, fast and provides reasonable accuracy. It employs depthwise separable convolutions and densely connected blocks.</p>
<h2 id="frontend-view---file-element"><a href="#frontend-view---file-element" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Frontend View - File element</h2>
<p>Here, we basically build a video frame 720x560 on the center of the screen which will project the camera video output and perform facial recognition on it. The snippet below builds the html page for it.</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ie=edge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token comment">&lt;!-- getting the open source and the local script module which we will build later --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">defer</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>face-api.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">defer</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>script.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token comment">&lt;!-- styling to make the video frame center and limit it's size --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
    <span class="token selector">body</span> <span class="token punctuation">{</span>
      <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token unit">vw</span><span class="token punctuation">;</span>
      <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token unit">vh</span><span class="token punctuation">;</span>
      <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
      <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
      <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector">canvas</span> <span class="token punctuation">{</span>
      <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!-- Adding the video frame with 560p dimension. Autoplay to start without hitting any button and muted because we don't need any sound  --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>video<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>720<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>560<span class="token punctuation">"</span></span> <span class="token attr-name">autoplay</span> <span class="token attr-name">muted</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
</code></pre></div>
<h2 id="application---the-script"><a href="#application---the-script" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Application - The Script</h2>
<p>The functions of the script are as follows:</p>
<ol>
<li>Load the required face-api models</li>
<li>Capture the live camera recording and render it on the video frame we built earlier on the html page</li>
<li>Get the video from the video frame, convert it to canvas, then draw the result of face detection, facial landmarks and facial expression on top of it every 0.1 second.</li>
</ol>
<p>The snippet below demonstrates the use of this technique.</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-javascript"><code><span class="token comment">//get the video tag</span>
<span class="token keyword">const</span> video <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'video'</span><span class="token punctuation">)</span>

<span class="token comment">//get all the required model and then calling start video function</span>
<span class="token known-class-name class-name">Promise</span><span class="token punctuation">.</span><span class="token method function property-access">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  faceapi<span class="token punctuation">.</span><span class="token property-access">nets</span><span class="token punctuation">.</span><span class="token property-access">tinyFaceDetector</span><span class="token punctuation">.</span><span class="token method function property-access">loadFromUri</span><span class="token punctuation">(</span><span class="token string">'/face-detection-cam/models'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  faceapi<span class="token punctuation">.</span><span class="token property-access">nets</span><span class="token punctuation">.</span><span class="token property-access">faceLandmark68Net</span><span class="token punctuation">.</span><span class="token method function property-access">loadFromUri</span><span class="token punctuation">(</span><span class="token string">'/face-detection-cam/models'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  faceapi<span class="token punctuation">.</span><span class="token property-access">nets</span><span class="token punctuation">.</span><span class="token property-access">faceExpressionNet</span><span class="token punctuation">.</span><span class="token method function property-access">loadFromUri</span><span class="token punctuation">(</span><span class="token string">'/face-detection-cam/models'</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span>startVideo<span class="token punctuation">)</span>

<span class="token comment">//this gets the camera input and renders it on our 720x560 video frame we built earlier</span>
<span class="token keyword">function</span> <span class="token function">startVideo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token dom variable">navigator</span><span class="token punctuation">.</span><span class="token method function property-access">getUserMedia</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span> video<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token parameter">stream</span> <span class="token arrow operator">=></span> video<span class="token punctuation">.</span><span class="token property-access">srcObject</span> <span class="token operator">=</span> stream<span class="token punctuation">,</span>
    <span class="token parameter">err</span> <span class="token arrow operator">=></span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//once the video starts playing, captures video frames and draws facial boxes, facial landmarks and facial expression on top of the detected faces in the frame every 0.1 second</span>

video<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">'play'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> canvas <span class="token operator">=</span> faceapi<span class="token punctuation">.</span><span class="token method function property-access">createCanvasFromMedia</span><span class="token punctuation">(</span>video<span class="token punctuation">)</span>
  <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span>
  <span class="token keyword">const</span> displaySize <span class="token operator">=</span> <span class="token punctuation">{</span> width<span class="token operator">:</span> video<span class="token punctuation">.</span><span class="token property-access">width</span><span class="token punctuation">,</span> height<span class="token operator">:</span> video<span class="token punctuation">.</span><span class="token property-access">height</span> <span class="token punctuation">}</span>
  faceapi<span class="token punctuation">.</span><span class="token method function property-access">matchDimensions</span><span class="token punctuation">(</span>canvas<span class="token punctuation">,</span> displaySize<span class="token punctuation">)</span>
  <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> detections <span class="token operator">=</span> <span class="token keyword control-flow">await</span> faceapi<span class="token punctuation">.</span><span class="token method function property-access">detectAllFaces</span><span class="token punctuation">(</span>video<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">faceapi<span class="token punctuation">.</span>TinyFaceDetectorOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">withFaceExpressions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> resizedDetections <span class="token operator">=</span> faceapi<span class="token punctuation">.</span><span class="token method function property-access">resizeResults</span><span class="token punctuation">(</span>detections<span class="token punctuation">,</span> displaySize<span class="token punctuation">)</span>
    canvas<span class="token punctuation">.</span><span class="token method function property-access">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> canvas<span class="token punctuation">.</span><span class="token property-access">width</span><span class="token punctuation">,</span> canvas<span class="token punctuation">.</span><span class="token property-access">height</span><span class="token punctuation">)</span>
    faceapi<span class="token punctuation">.</span><span class="token property-access">draw</span><span class="token punctuation">.</span><span class="token method function property-access">drawDetections</span><span class="token punctuation">(</span>canvas<span class="token punctuation">,</span> resizedDetections<span class="token punctuation">)</span>
    faceapi<span class="token punctuation">.</span><span class="token property-access">draw</span><span class="token punctuation">.</span><span class="token method function property-access">drawFaceLandmarks</span><span class="token punctuation">(</span>canvas<span class="token punctuation">,</span> resizedDetections<span class="token punctuation">)</span>
    faceapi<span class="token punctuation">.</span><span class="token property-access">draw</span><span class="token punctuation">.</span><span class="token method function property-access">drawFaceExpressions</span><span class="token punctuation">(</span>canvas<span class="token punctuation">,</span> resizedDetections<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div>
<h2 id="live-demonstration"><a href="#live-demonstration" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Live Demonstration</h2>
<p>You can follow this link to get the live demonstration of the facial expression detection cam, we built here.
<a href="https://chivalryytf.me/face-detection-cam" rel="nofollow noopener noreferrer" target="_blank">https://chivalryytf.me/face-detection-cam</a></p></div> <div class="flex justify-between space-x-4 mt-16"><a href="/blog/optimizing-and-resizing-images-using-canvas-api" class="no-underline">
    Resizing and Optimizing Images Using Canvas API
  </a> <span> </span></div></article></main> <footer class="flex text-sm text-gray-600 justify-center p-4 bg-gray-100"><div>
      © Prashant Shrestha 2021
    </div> <a href="https://twitter.com/chivalryytf" target="_blank" class="h-6 w-6 ml-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current"><path d="M10 .4C4.698.4.4 4.698.4 10s4.298 9.6 9.6 9.6 9.6-4.298 9.6-9.6S15.302.4 10 .4zm3.905 7.864c.004.082.005.164.005.244 0 2.5-1.901 5.381-5.379 5.381a5.335 5.335 0 0 1-2.898-.85c.147.018.298.025.451.025.886 0 1.701-.301 2.348-.809a1.895 1.895 0 0 1-1.766-1.312 1.9 1.9 0 0 0 .853-.033 1.892 1.892 0 0 1-1.517-1.854v-.023c.255.141.547.227.857.237a1.89 1.89 0 0 1-.585-2.526 5.376 5.376 0 0 0 3.897 1.977 1.891 1.891 0 0 1 3.222-1.725 3.797 3.797 0 0 0 1.2-.459 1.9 1.9 0 0 1-.831 1.047 3.799 3.799 0 0 0 1.086-.299 3.834 3.834 0 0 1-.943.979z"></path></svg></a> <a href="https://github.com/chivalryytf" target="_blank" class="h-6 w-6 ml-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current"><path d="M10.015 9.949h-.03c-1.191 0-2.24-.303-2.861.268a1.57 1.57 0 0 0-.527 1.197c0 1.852 1.483 2.08 3.389 2.08h.029c1.905 0 3.389-.229 3.389-2.08 0-.443-.156-.856-.527-1.197-.622-.571-1.671-.268-2.862-.268zM8.393 12.48c-.363 0-.656-.408-.656-.91s.293-.908.656-.908c.363 0 .657.406.657.908.001.502-.293.91-.657.91zm3.213 0c-.363 0-.657-.408-.657-.91s.294-.908.657-.908c.362 0 .656.406.656.908.001.502-.293.91-.656.91zM10 .4C4.698.4.4 4.698.4 10s4.298 9.6 9.6 9.6 9.6-4.298 9.6-9.6S15.302.4 10 .4zm.876 13.539c-.172 0-.514 0-.876.002-.362-.002-.704-.002-.876-.002-.76 0-3.772-.059-3.772-3.689 0-.834.286-1.445.755-1.955-.074-.184-.078-1.232.32-2.236 0 0 .916.1 2.301 1.051.289-.081.781-.122 1.272-.122s.982.041 1.273.121c1.385-.951 2.301-1.051 2.301-1.051.398 1.004.395 2.053.32 2.236.469.51.755 1.121.755 1.955-.001 3.632-3.013 3.69-3.773 3.69z"></path></svg></a> <a href="https://www.linkedin.com/in/chivalryytf" target="_blank" class="h-6 w-6 ml-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current"><path d="M10 .4C4.698.4.4 4.698.4 10s4.298 9.6 9.6 9.6 9.6-4.298 9.6-9.6S15.302.4 10 .4zM7.65 13.979H5.706V7.723H7.65v6.256zm-.984-7.024c-.614 0-1.011-.435-1.011-.973 0-.549.409-.971 1.036-.971s1.011.422 1.023.971c0 .538-.396.973-1.048.973zm8.084 7.024h-1.944v-3.467c0-.807-.282-1.355-.985-1.355-.537 0-.856.371-.997.728-.052.127-.065.307-.065.486v3.607H8.814v-4.26c0-.781-.025-1.434-.051-1.996h1.689l.089.869h.039c.256-.408.883-1.01 1.932-1.01 1.279 0 2.238.857 2.238 2.699v3.699z"></path></svg></a> <a href="mailto:chivalryytf@gmail.com" target="_blank" class="h-6 w-6 ml-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current"><path d="M10 .4C4.698.4.4 4.698.4 10s4.298 9.6 9.6 9.6 9.6-4.298 9.6-9.6S15.302.4 10 .4zM6.231 7h7.52c.399 0 .193.512-.024.643-.217.13-3.22 1.947-3.333 2.014s-.257.1-.403.1a.793.793 0 0 1-.402-.1L6.255 7.643C6.038 7.512 5.833 7 6.231 7zM14 12.5c0 .21-.252.5-.444.5H6.444C6.252 13 6 12.71 6 12.5V8.853c0-.092-.002-.211.172-.11l3.417 2.015a.69.69 0 0 0 .402.1.69.69 0 0 0 .403-.1l3.434-2.014c.174-.102.172.018.172.11V12.5z"></path></svg></a></footer></div></div></div><script>window.__NUXT__={staticAssetsBase:"/_nuxt/static/1616000276",layout:"default",error:null,serverRendered:!0,routePath:"/blog/implementing-facial-expression-detection-cam",config:{content:{dbHash:"cfd91a25"}}}</script><script src="/_nuxt/c4e5260.js" defer></script><script src="/_nuxt/caea6eb.js" defer></script><script src="/_nuxt/ee1435b.js" defer></script><script src="/_nuxt/e730602.js" defer></script><script src="/_nuxt/2b20522.js" defer></script>
  </body>
</html>

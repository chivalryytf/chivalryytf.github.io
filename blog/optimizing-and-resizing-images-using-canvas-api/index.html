<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Resizing and Optimizing Images Using Canvas API - chivalryytf.me</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="charset" charset="utf-8"><meta data-n-head="ssr" data-hid="mobile-web-app-capable" name="mobile-web-app-capable" content="yes"><meta data-n-head="ssr" data-hid="apple-mobile-web-app-title" name="apple-mobile-web-app-title" content="Prashant Shrestha - Codeok"><meta data-n-head="ssr" data-hid="author" name="author" content="Prashant Shrestha"><meta data-n-head="ssr" data-hid="og:type" name="og:type" property="og:type" content="website"><meta data-n-head="ssr" data-hid="og:site_name" name="og:site_name" property="og:site_name" content="Prashant Shrestha - Codeok"><meta data-n-head="ssr" data-hid="twitter:site" name="twitter:site" property="twitter:site" content="@chivalryytf"><meta data-n-head="ssr" data-hid="twitter:creator" name="twitter:creator" property="twitter:creator" content="@chivalryytf"><meta data-n-head="ssr" data-hid="og:url" name="og:url" property="og:url" content="https://chivalryytf.me/blog/optimizing-and-resizing-images-using-canvas-api"><meta data-n-head="ssr" data-hid="og:title" name="og:title" property="og:title" content="Resizing and Optimizing Images Using Canvas API - chivalryytf.me"><meta data-n-head="ssr" data-hid="description" name="description" content="How to resize and optimize images before uploading them to Cloud Storage using Canvas API"><meta data-n-head="ssr" data-hid="og:description" name="og:description" property="og:description" content="How to resize and optimize images before uploading them to Cloud Storage using Canvas API"><meta data-n-head="ssr" data-hid="og:image" name="og:image" property="og:image" content="https://firebasestorage.googleapis.com/v0/b/chivalryytf-e6a04.appspot.com/o/blogs%2Fresizing-and-optimizing-images-using-canvas-api%2Fapple-computer-desk-devices-326501.jpg?alt=media&token=150fc1fd-5061-40ed-bc31-7a6ef72941a9"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="preconnect" href="https://fonts.gstatic.com"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,400;0,700;1,400;1,700&display=swap"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&display=swap"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&display=swap"><link data-n-head="ssr" rel="shortcut icon" href="/_nuxt/icons/icon_64x64.9521ea.png"><link data-n-head="ssr" rel="apple-touch-icon" href="/_nuxt/icons/icon_512x512.9521ea.png" sizes="512x512"><link data-n-head="ssr" rel="manifest" href="/_nuxt/manifest.1c5e4b56.json" data-hid="manifest"><link data-n-head="ssr" rel="canonical" href="https://chivalryytf.me/blog/optimizing-and-resizing-images-using-canvas-api"><script data-n-head="ssr" type="application/ld+json">{"@type":"Article","datePublished":"2020-03-06T08:30:27.601Z","dateModified":"2020-03-06T09:52:47.539Z","headline":"Resizing and Optimizing Images Using Canvas API","image":{"image":"https://firebasestorage.googleapis.com/v0/b/chivalryytf-e6a04.appspot.com/o/blogs%2Fresizing-and-optimizing-images-using-canvas-api%2Fapple-computer-desk-devices-326501.jpg?alt=media&amp;token=150fc1fd-5061-40ed-bc31-7a6ef72941a9","alt":"Optimizing and Resizing Images Using Canvas API cover image","caption":"Photo by Tranmautritam from Pexels","thumb":"https://firebasestorage.googleapis.com/v0/b/chivalryytf-e6a04.appspot.com/o/blogs%2Fresizing-and-optimizing-images-using-canvas-api%2Fsmall-apple-computer-desk-devices-326501_thumb.jpg?alt=media&amp;token=fc13f802-f72f-4d5d-85e6-4e0124b23ff8"}}</script><link rel="preload" href="/_nuxt/c4e5260.js" as="script"><link rel="preload" href="/_nuxt/ee1435b.js" as="script"><link rel="preload" href="/_nuxt/e730602.js" as="script"><link rel="preload" href="/_nuxt/2b20522.js" as="script"><link rel="preload" href="/_nuxt/caea6eb.js" as="script"><style data-vue-ssr-id="0211d3d2:0 5a159abf:0 1b4296a6:0 fa7ff0ca:0 5c2eaa1a:0">/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}button{background-color:transparent;background-image:none}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}html{font-family:Source Sans Pro,sans-serif;line-height:1.5}*,:after,:before{box-sizing:border-box;border:0 solid #e2e8f0}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#a0aec0}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#a0aec0}input::placeholder,textarea::placeholder{color:#a0aec0}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit}code,kbd,pre,samp{font-family:Inconsolata,monospace}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}.space-x-4>:not(template)~:not(template){--space-x-reverse:0;margin-right:calc(1rem*var(--space-x-reverse));margin-left:calc(1rem*(1 - var(--space-x-reverse)))}.appearance-none{-webkit-appearance:none;-moz-appearance:none;appearance:none}.bg-white{--bg-opacity:1;background-color:#fff;background-color:rgba(255,255,255,var(--bg-opacity))}.bg-gray-100{--bg-opacity:1;background-color:#f7fafc;background-color:rgba(247,250,252,var(--bg-opacity))}.hover\:bg-gray-200:hover{--bg-opacity:1;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity))}.border-transparent{border-color:transparent}.border-gray-200{--border-opacity:1;border-color:#edf2f7;border-color:rgba(237,242,247,var(--border-opacity))}.rounded{border-radius:.25rem}.rounded-t{border-top-left-radius:.25rem;border-top-right-radius:.25rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.table{display:table}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.flex-grow{flex-grow:1}.font-serif{font-family:Libre Baskerville,serif}.font-mono{font-family:Inconsolata,monospace}.font-bold{font-weight:700}.h-5{height:1.25rem}.h-6{height:1.5rem}.h-auto{height:auto}.text-xs{font-size:.75rem}.text-sm{font-size:.875rem}.text-2xl{font-size:1.5rem}.leading-normal{line-height:1.5}.list-none{list-style-type:none}.my-4{margin-top:1rem;margin-bottom:1rem}.my-8{margin-top:2rem;margin-bottom:2rem}.mx-auto{margin-left:auto;margin-right:auto}.mt-1{margin-top:.25rem}.mr-2{margin-right:.5rem}.ml-2{margin-left:.5rem}.mb-4{margin-bottom:1rem}.ml-5{margin-left:1.25rem}.mb-8{margin-bottom:2rem}.mt-16{margin-top:4rem}.max-w-screen-md{max-width:768px}.min-h-screen{min-height:100vh}.object-contain{-o-object-fit:contain;object-fit:contain}.object-cover{-o-object-fit:cover;object-fit:cover}.outline-none{outline:2px solid transparent;outline-offset:2px}.p-4{padding:1rem}.px-0{padding-left:0;padding-right:0}.py-2{padding-top:.5rem;padding-bottom:.5rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.pl-1{padding-left:.25rem}.pb-2{padding-bottom:.5rem}.pl-3{padding-left:.75rem}.pr-4{padding-right:1rem}.pb-8{padding-bottom:2rem}.pl-10{padding-left:2.5rem}.pt-32{padding-top:8rem}.placeholder-gray-600::-moz-placeholder{--placeholder-opacity:1;color:#718096;color:rgba(113,128,150,var(--placeholder-opacity))}.placeholder-gray-600:-ms-input-placeholder{--placeholder-opacity:1;color:#718096;color:rgba(113,128,150,var(--placeholder-opacity))}.placeholder-gray-600::placeholder{--placeholder-opacity:1;color:#718096;color:rgba(113,128,150,var(--placeholder-opacity))}.pointer-events-none{pointer-events:none}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-y-0{top:0;bottom:0}.right-0{right:0}.left-0{left:0}.shadow-sm{box-shadow:0 1px 2px 0 rgba(0,0,0,.05)}.shadow{box-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px 0 rgba(0,0,0,.06)}.shadow-lg{box-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.05)}.fill-current{fill:currentColor}.text-gray-600{--text-opacity:1;color:#718096;color:rgba(113,128,150,var(--text-opacity))}.text-gray-700{--text-opacity:1;color:#4a5568;color:rgba(74,85,104,var(--text-opacity))}.hover\:text-gray-800:hover,.text-gray-800{--text-opacity:1;color:#2d3748;color:rgba(45,55,72,var(--text-opacity))}.uppercase{text-transform:uppercase}.no-underline{text-decoration:none}.w-0{width:0}.w-5{width:1.25rem}.w-6{width:1.5rem}.w-8{width:2rem}.w-full{width:100%}.z-10{z-index:10}.z-50{z-index:50}.transition-colors{transition-property:background-color,border-color,color,fill,stroke}.ease-linear{transition-timing-function:linear}.duration-300{transition-duration:.3s}@-webkit-keyframes spin{to{transform:rotate(1turn)}}@keyframes spin{to{transform:rotate(1turn)}}@-webkit-keyframes ping{75%,to{transform:scale(2);opacity:0}}@keyframes ping{75%,to{transform:scale(2);opacity:0}}@-webkit-keyframes pulse{50%{opacity:.5}}@keyframes pulse{50%{opacity:.5}}@-webkit-keyframes bounce{0%,to{transform:translateY(-25%);-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1)}}@keyframes bounce{0%,to{transform:translateY(-25%);-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1)}}@media (min-width:640px){.sm\:container{width:100%}}@media (min-width:640px) and (min-width:640px){.sm\:container{max-width:640px}}@media (min-width:640px) and (min-width:768px){.sm\:container{max-width:768px}}@media (min-width:640px) and (min-width:1024px){.sm\:container{max-width:1024px}}@media (min-width:640px) and (min-width:1280px){.sm\:container{max-width:1280px}}@media (min-width:640px){.sm\:bg-gray-200{--bg-opacity:1;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity))}.sm\:rounded-none{border-radius:0}.sm\:flex{display:flex}.sm\:flex-row-reverse{flex-direction:row-reverse}.sm\:justify-between{justify-content:space-between}.sm\:flex-shrink-0{flex-shrink:0}.sm\:ml-4{margin-left:1rem}.sm\:p-0{padding:0}.sm\:p-4{padding:1rem}.sm\:px-0{padding-left:0;padding-right:0}.sm\:pr-4{padding-right:1rem}.sm\:pl-10{padding-left:2.5rem}.sm\:relative{position:relative}.sm\:w-1\/3{width:33.333333%}.sm\:w-1\/4{width:25%}.sm\:w-full{width:100%}}@media (min-width:768px){.md\:container{width:100%}}@media (min-width:768px) and (min-width:640px){.md\:container{max-width:640px}}@media (min-width:768px) and (min-width:768px){.md\:container{max-width:768px}}@media (min-width:768px) and (min-width:1024px){.md\:container{max-width:1024px}}@media (min-width:768px) and (min-width:1280px){.md\:container{max-width:1280px}}@media (min-width:1024px){.lg\:container{width:100%}}@media (min-width:1024px) and (min-width:640px){.lg\:container{max-width:640px}}@media (min-width:1024px) and (min-width:768px){.lg\:container{max-width:768px}}@media (min-width:1024px) and (min-width:1024px){.lg\:container{max-width:1024px}}@media (min-width:1024px) and (min-width:1280px){.lg\:container{max-width:1280px}}@media (min-width:1024px){.lg\:justify-around{justify-content:space-around}}@media (min-width:1280px){.xl\:container{width:100%}}@media (min-width:1280px) and (min-width:640px){.xl\:container{max-width:640px}}@media (min-width:1280px) and (min-width:768px){.xl\:container{max-width:768px}}@media (min-width:1280px) and (min-width:1024px){.xl\:container{max-width:1024px}}@media (min-width:1280px) and (min-width:1280px){.xl\:container{max-width:1280px}}body{--text-opacity:1;color:#2d3748;color:rgba(45,55,72,var(--text-opacity));font-size:1.125rem}h1{font-size:2.25rem;font-family:Libre Baskerville,serif}h2{font-size:1.5rem}a{color:#4299e1;color:rgba(66,153,225,var(--text-opacity));text-decoration:underline}a,a:hover{--text-opacity:1}a:hover{color:#2b6cb0;color:rgba(43,108,176,var(--text-opacity))}ol,p,ul{margin-bottom:1rem}ol,ul{padding-left:2rem;margin-top:1rem}ul{list-style-type:disc}ol{list-style-type:decimal}li>ol,li>p,li>ul{margin:0}blockquote{border-left-width:4px;--border-opacity:1;border-color:#718096;border-color:rgba(113,128,150,var(--border-opacity));font-style:italic;padding-left:1rem}figure img{width:100%}figcaption{font-size:.875rem;--text-opacity:1;color:#718096;color:rgba(113,128,150,var(--text-opacity));text-align:center}p code{display:inline-block;font-weight:700}.nuxt-content-highlight{margin-bottom:1rem;position:relative}.nuxt-content-highlight .filename{position:absolute;right:0;--text-opacity:1;color:#718096;color:rgba(113,128,150,var(--text-opacity));z-index:10;margin-right:.5rem;margin-top:.5rem;font-size:.875rem}.nuxt-content h1,.nuxt-content h2{font-family:Source Sans Pro,sans-serif;font-size:2.25rem;margin-bottom:.5rem}.nuxt-content h3{font-size:1.875rem;margin-bottom:.5rem}.nuxt-content h4{font-size:1.5rem;margin-bottom:.5rem}.nuxt-content img{margin-left:auto;margin-right:auto;width:100%}code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:0 0;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8292a2}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#00f;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}.search-box--focus[data-v-3b9193e8],.search-box[data-v-3b9193e8]:focus{width:100%;padding-left:2.5rem;padding-right:1rem;--bg-opacity:1;background-color:#fff;background-color:rgba(255,255,255,var(--bg-opacity));box-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px 0 rgba(0,0,0,.06);border-width:1px;--border-opacity:1;border-color:#edf2f7;border-color:rgba(237,242,247,var(--border-opacity))}.search-results[data-v-3b9193e8]{top:-5px}</style><link rel="preload" href="/_nuxt/static/1615999718/blog/optimizing-and-resizing-images-using-canvas-api/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1615999718/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div class="flex flex-col min-h-screen"><header class="p-4 border-b shadow-sm fixed w-full z-10 bg-white flex items-center sm:justify-between lg:justify-around"><a href="/" class="font-mono font-bold text-2xl text-gray-800 no-underline hover:text-gray-800 nuxt-link-active"><span><img src="/icon.png" class="inline w-8 object-contain"> chivalryytf.me</span></a> <div class="absolute right-0 px-4 sm:relative sm:px-0 sm:w-1/3 sm:relative" data-v-3b9193e8><div class="w-full" data-v-3b9193e8><input type="search" autocomplete="off" placeholder="Search" class="search-box border border-transparent text-gray-700 placeholder-gray-600 rounded py-2 px-5 block w-0 appearance-none leading-normal outline-none sm:w-full sm:pl-10 sm:pr-4 sm:bg-gray-200" data-v-3b9193e8> <div class="px-4 relative" data-v-3b9193e8><!----></div></div> <div class="pointer-events-none absolute inset-y-0 pl-3 flex items-center" data-v-3b9193e8><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="search-icon fill-current pointer-events-none text-gray-600 w-5 h-5" data-v-3b9193e8><path d="M12.9 14.32a8 8 0 1 1 1.41-1.41l5.35 5.33-1.42 1.42-5.33-5.34zM8 14A6 6 0 1 0 8 2a6 6 0 0 0 0 12z" data-v-3b9193e8></path></svg></div></div></header> <main class="flex-grow pt-32 pb-8 px-4 max-w-screen-md mx-auto w-full"><article><div class="uppercase text-xs font-bold text-gray-600"><div class="mr-2 inline-block">
      Canvas API
    </div><div class="mr-2 inline-block">
      Cloud Storage
    </div><div class="mr-2 inline-block">
      Firebase
    </div><div class="mr-2 inline-block">
      Nuxt
    </div></div> <h1>
    Resizing and Optimizing Images Using Canvas API
  </h1> <h2 class="text-gray-700">
    The Canvas API provides a means, among other things, to manipulate photos, which is perfect for resizing and optimizing images before uploading them to Cloud Firestore.
  </h2> <div class="text-sm text-gray-600">
    March 6, 2020
  </div> <figure class="my-4"><img src="https://firebasestorage.googleapis.com/v0/b/chivalryytf-e6a04.appspot.com/o/blogs%2Fresizing-and-optimizing-images-using-canvas-api%2Fapple-computer-desk-devices-326501.jpg?alt=media&token=150fc1fd-5061-40ed-bc31-7a6ef72941a9" alt="Optimizing and Resizing Images Using Canvas API cover image"> <figcaption>Photo by Tranmautritam from Pexels</figcaption></figure> <nav><ul class="px-4 my-4"><li class="pb-2 pl-1"><a href="/blog/optimizing-and-resizing-images-using-canvas-api#canvas-api" class="no-underline">
          Canvas API
        </a></li><li class="pb-2 pl-1"><a href="/blog/optimizing-and-resizing-images-using-canvas-api#frontend-view---file-element" class="no-underline">
          Frontend View - File element
        </a></li><li class="pb-2 pl-1"><a href="/blog/optimizing-and-resizing-images-using-canvas-api#application---the-script" class="no-underline">
          Application - The Script
        </a></li><li class="pb-2 pl-1"><a href="/blog/optimizing-and-resizing-images-using-canvas-api#alternatives" class="no-underline">
          Alternatives
        </a></li></ul></nav> <div class="my-8 nuxt-content"><p>In web development, resizing is a common practice done before uploading any image to a cloud storage. In addition to saving space, reducing the image size before uploading ensures that the image will be the same size across all web browsers. Not all web browsers render HTML in quite the same way, so resizing on the browser side can lead to images not displaying correctly. Therefore, it's also a safe practice to resize images before uploading them. In this article, we shall look into how to resize and optimize an image before uploading it.</p>
<h2 id="canvas-api"><a href="#canvas-api" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Canvas API</h2>
<p>According to <a href="https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API" rel="nofollow noopener noreferrer" target="_blank">MDN</a>:</p>
<blockquote>
<p>The <strong>Canvas API</strong> provides a means for drawing graphics via <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript" rel="nofollow noopener noreferrer" target="_blank">JavaScript</a> and the <a href="https://developer.mozilla.org/en-US/docs/Web/HTML" rel="nofollow noopener noreferrer" target="_blank">HTML</a> <code>&lt;canvas></code> element. Among other things, it can be used for animation, game graphics, data visualization, photo manipulation, and real-time video processing.</p>
</blockquote>
<p>Going through the documentation, it looks like the Canvas API is ideal for manipulating images on the browser. Since our goal is to <strong>resize</strong> and <strong>optimize</strong> an image, the basic steps we need are:</p>
<ol>
<li>
<p>Resize the image using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/drawImage" rel="nofollow noopener noreferrer" target="_blank">drawImage()</a> function.</p>
</li>
<li>
<p>Optimize the image using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toBlob" rel="nofollow noopener noreferrer" target="_blank">toBlob()</a> function.</p>
</li>
</ol>
<h2 id="frontend-view---file-element"><a href="#frontend-view---file-element" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Frontend View - File element</h2>
<p>The file element is one of those things that's a bit troublesome to style and in most cases you'd find it more practical to just hide it completely. The common technique is to simply hide the file input element and have another element trigger a <code>click</code> event on the file input element.</p>
<p>The snippet below demonstrates the use of this technique. In addition, a preview of the image is added to create a "compound" element, which enhances an otherwise plain file input element.</p>
<p>I'm using <a href="https://tailwindcss.com/" rel="nofollow noopener noreferrer" target="_blank">Tailwind CSS</a>. You can refer to its <a href="https://tailwindcss.com/docs/utility-first" rel="nofollow noopener noreferrer" target="_blank">documentation</a> for the effects of the CSS classes used.</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>imageUrl<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Image<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>blog.imageUrl<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token comment">&lt;!-- A preview of the image. --></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>blog.imageUrl<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>w-24 md:w-32 h-auto object-cover inline-block<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!-- Clicking this button triggers the "click" event of the file input. --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
      <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>!blog.imageUrl<span class="token punctuation">"</span></span>
      <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>launchImageFile<span class="token punctuation">"</span></span>
      <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>isUploadingImage<span class="token punctuation">"</span></span>
      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span>
    <span class="token punctuation">></span></span>
      {{ isUploadingImage ? 'Uploading...' : 'Upload' }}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!-- This is the real file input element which we are hiding --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
      <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>imageFile<span class="token punctuation">"</span></span>
      <span class="token attr-name">@change.prevent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>uploadImageFile($event.target.files)<span class="token punctuation">"</span></span>
      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span>
      <span class="token attr-name">accept</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>image/png, image/jpeg<span class="token punctuation">"</span></span>
      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span>
    <span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
</code></pre></div>
<h2 id="application---the-script"><a href="#application---the-script" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Application - The Script</h2>
<p>A blog site usually uses 2 images - a cover image and a thumbnail version of the cover. Rather than having to manually resize the images, it would be ideal to upload a single image and let the application create the thumbnail variation that has a smaller width (&lt; 640px). In addition, it is also better to resize the original image to a more reasonable size of around 1280px width.</p>
<p>We need a template that does the following:</p>
<ol>
<li>
<p>Create a resized optimized version of the original image to be used as the cover.</p>
</li>
<li>
<p>Create a resized optimized version of the original image to be used as the thumbnail.</p>
</li>
<li>
<p>Upload both versions to Firebase Cloud Firestore and store the download URLs in blog.</p>
</li>
</ol>
<p>The snippet below demonstrates the use of this technique.</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-js"><code><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
      blog<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      isUploadingImage<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token constant">FULL_IMAGE</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        maxDimension<span class="token operator">:</span> <span class="token number">1280</span><span class="token punctuation">,</span>
        quality<span class="token operator">:</span> <span class="token number">0.9</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token constant">THUMB_IMAGE</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        maxDimension<span class="token operator">:</span> <span class="token number">640</span><span class="token punctuation">,</span>
        quality<span class="token operator">:</span> <span class="token number">0.7</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">launchImageFile</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Trigger the file input click event, which launches</span>
      <span class="token comment">// the file dialog window.</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">$refs</span><span class="token punctuation">.</span><span class="token property-access">imageFile</span><span class="token punctuation">.</span><span class="token method function property-access">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">async</span> <span class="token function">uploadImageFile</span> <span class="token punctuation">(</span><span class="token parameter">files</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>files<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">return</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">const</span> file <span class="token operator">=</span> files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">.</span><span class="token property-access">type</span><span class="token punctuation">.</span><span class="token method function property-access">match</span><span class="token punctuation">(</span><span class="token string">'image.*'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Please upload an image.'</span><span class="token punctuation">)</span>
        <span class="token keyword control-flow">return</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">const</span> metadata <span class="token operator">=</span> <span class="token punctuation">{</span>
        contentType<span class="token operator">:</span> file<span class="token punctuation">.</span><span class="token property-access">type</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// Generate the cover.</span>
      <span class="token keyword">const</span> fullImageResizePromise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">generateVariation</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token constant">FULL_IMAGE</span><span class="token punctuation">.</span><span class="token property-access">maxDimension</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token constant">FULL_IMAGE</span><span class="token punctuation">.</span><span class="token property-access">quality</span><span class="token punctuation">,</span> resolve<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>

      <span class="token comment">// Generate the thumbnail.</span>
      <span class="token keyword">const</span> thumbImageResizePromise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">generateVariation</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token constant">THUMB_IMAGE</span><span class="token punctuation">.</span><span class="token property-access">maxDimension</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token constant">THUMB_IMAGE</span><span class="token punctuation">.</span><span class="token property-access">quality</span><span class="token punctuation">,</span> resolve<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      
      <span class="token keyword">const</span> images <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token known-class-name class-name">Promise</span><span class="token punctuation">.</span><span class="token method function property-access">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>fullImageResizePromise<span class="token punctuation">,</span> thumbImageResizePromise<span class="token punctuation">]</span><span class="token punctuation">)</span>

      <span class="token comment">// Upload the cover.</span>
      <span class="token keyword">const</span> fullImageUploadPromise <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">uploadSingleImageFile</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">,</span> images<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> metadata<span class="token punctuation">)</span>

      <span class="token comment">// Upload the thumbnail with a slight change in the filename.</span>
      <span class="token keyword">const</span> thumbFileName <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">.</span><span class="token method function property-access">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> file<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">.</span><span class="token method function property-access">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'_thumb.'</span> <span class="token operator">+</span> file<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">.</span><span class="token method function property-access">substring</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">.</span><span class="token method function property-access">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> thumbImageUploadPromise <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">uploadSingleImageFile</span><span class="token punctuation">(</span>thumbFileName<span class="token punctuation">,</span> images<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> metadata<span class="token punctuation">)</span>

      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">isUploadingImage</span> <span class="token operator">=</span> <span class="token boolean">true</span>

      <span class="token comment">// Once both files have been uploaded, update the blog details.</span>
      <span class="token keyword control-flow">return</span> <span class="token known-class-name class-name">Promise</span><span class="token punctuation">.</span><span class="token method function property-access">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>fullImageUploadPromise<span class="token punctuation">,</span> thumbImageUploadPromise<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">results</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">blog</span><span class="token punctuation">.</span><span class="token property-access">imageUrl</span> <span class="token operator">=</span> results<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">blog</span><span class="token punctuation">.</span><span class="token property-access">teaserImageUrl</span> <span class="token operator">=</span> results<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token keyword control-flow">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">isUploadingImage</span> <span class="token operator">=</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">uploadSingleImageFile</span> <span class="token punctuation">(</span><span class="token parameter">filename<span class="token punctuation">,</span> blob<span class="token punctuation">,</span> metadata</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Create a reference to the destination where we're uploading</span>
      <span class="token comment">// the file.</span>
      <span class="token keyword">const</span> storage <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">$firebase</span><span class="token punctuation">.</span><span class="token method function property-access">storage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> imageRef <span class="token operator">=</span> storage<span class="token punctuation">.</span><span class="token method function property-access">ref</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">images/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>filename<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>

      <span class="token keyword">const</span> uploadTask <span class="token operator">=</span> imageRef<span class="token punctuation">.</span><span class="token method function property-access">put</span><span class="token punctuation">(</span>blob<span class="token punctuation">,</span> metadata<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">snapshot</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token comment">// Once the image is uploaded, obtain the download URL, which</span>
        <span class="token comment">// is the publicly accessible URL of the image.</span>
        <span class="token keyword control-flow">return</span> snapshot<span class="token punctuation">.</span><span class="token property-access">ref</span><span class="token punctuation">.</span><span class="token method function property-access">getDownloadURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
          <span class="token keyword control-flow">return</span> url
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword control-flow">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token comment">// eslint-disable-next-line no-console</span>
        <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">'Error uploading image'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>

      <span class="token keyword control-flow">return</span> uploadTask
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">generateVariation</span> <span class="token punctuation">(</span><span class="token parameter">file<span class="token punctuation">,</span> maxDimension<span class="token punctuation">,</span> quality<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Create an image element that will store our optimized image.</span>
      <span class="token keyword">const</span> <span class="token function-variable function">displayPicture</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        image<span class="token punctuation">.</span><span class="token property-access">src</span> <span class="token operator">=</span> url
        image<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> canvas <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">getScaledCanvas</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> maxDimension<span class="token punctuation">)</span>
          
          <span class="token comment">// Once we have the resized image, further optimize it using</span>
          <span class="token comment">// the toBlob() function.</span>
          canvas<span class="token punctuation">.</span><span class="token method function property-access">toBlob</span><span class="token punctuation">(</span>cb<span class="token punctuation">,</span> <span class="token string">'image/jpeg'</span><span class="token punctuation">,</span> quality<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">const</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      reader<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">onload</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">displayPicture</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">result</span><span class="token punctuation">)</span>
      reader<span class="token punctuation">.</span><span class="token method function property-access">readAsDataURL</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">getScaledCanvas</span> <span class="token punctuation">(</span><span class="token parameter">image<span class="token punctuation">,</span> maxDimension</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// This is where we actually resize the image using the</span>
      <span class="token comment">// drawImage() function.</span>
      <span class="token keyword">const</span> scaledCanvas <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span>

      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>image<span class="token punctuation">.</span><span class="token property-access">width</span> <span class="token operator">></span> maxDimension <span class="token operator">||</span> image<span class="token punctuation">.</span><span class="token property-access">height</span> <span class="token operator">></span> maxDimension<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>image<span class="token punctuation">.</span><span class="token property-access">width</span> <span class="token operator">></span> image<span class="token punctuation">.</span><span class="token property-access">height</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          scaledCanvas<span class="token punctuation">.</span><span class="token property-access">width</span> <span class="token operator">=</span> maxDimension
          scaledCanvas<span class="token punctuation">.</span><span class="token property-access">height</span> <span class="token operator">=</span> <span class="token punctuation">(</span>maxDimension <span class="token operator">*</span> image<span class="token punctuation">.</span><span class="token property-access">height</span><span class="token punctuation">)</span> <span class="token operator">/</span> image<span class="token punctuation">.</span><span class="token property-access">width</span>
        <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
          scaledCanvas<span class="token punctuation">.</span><span class="token property-access">width</span> <span class="token operator">=</span> <span class="token punctuation">(</span>maxDimension <span class="token operator">*</span> image<span class="token punctuation">.</span><span class="token property-access">width</span><span class="token punctuation">)</span> <span class="token operator">/</span> image<span class="token punctuation">.</span><span class="token property-access">height</span>
          scaledCanvas<span class="token punctuation">.</span><span class="token property-access">height</span> <span class="token operator">=</span> maxDimension
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
        scaledCanvas<span class="token punctuation">.</span><span class="token property-access">width</span> <span class="token operator">=</span> image<span class="token punctuation">.</span><span class="token property-access">width</span>
        scaledCanvas<span class="token punctuation">.</span><span class="token property-access">height</span> <span class="token operator">=</span> image<span class="token punctuation">.</span><span class="token property-access">height</span>
      <span class="token punctuation">}</span>
      scaledCanvas
        <span class="token punctuation">.</span><span class="token method function property-access">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token method function property-access">drawImage</span><span class="token punctuation">(</span>
          image<span class="token punctuation">,</span>
          <span class="token number">0</span><span class="token punctuation">,</span>
          <span class="token number">0</span><span class="token punctuation">,</span>
          image<span class="token punctuation">.</span><span class="token property-access">width</span><span class="token punctuation">,</span>
          image<span class="token punctuation">.</span><span class="token property-access">height</span><span class="token punctuation">,</span>
          <span class="token number">0</span><span class="token punctuation">,</span>
          <span class="token number">0</span><span class="token punctuation">,</span>
          scaledCanvas<span class="token punctuation">.</span><span class="token property-access">width</span><span class="token punctuation">,</span>
          scaledCanvas<span class="token punctuation">.</span><span class="token property-access">height</span>
        <span class="token punctuation">)</span>
      <span class="token keyword control-flow">return</span> scaledCanvas
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h2 id="alternatives"><a href="#alternatives" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Alternatives</h2>
<p>If you are using Firebase, you can choose to optimize the images using <a href="https://firebase.google.com/docs/functions" rel="nofollow noopener noreferrer" target="_blank">Cloud Functions</a>. <a href="https://github.com/firebase/functions-samples/tree/master/quickstarts/thumbnails" rel="nofollow noopener noreferrer" target="_blank">This approach</a> performs the optimization on the server automatically whenever a new image is uploaded. There's even a <a href="https://firebase.google.com/products/extensions/storage-resize-images" rel="nofollow noopener noreferrer" target="_blank">prebuilt function</a> that you can immediately use without any coding. It is definitely worth checking out.</p></div> <div class="flex justify-between space-x-4 mt-16"><a href="/blog/introduction" class="no-underline">
    An introduction
  </a> <a href="/blog/implementing-facial-expression-detection-cam" class="no-underline">
    Implementing Live Facial Expression Detection on Web Browser using open-source Face-Api
  </a></div></article></main> <footer class="flex text-sm text-gray-600 justify-center p-4 bg-gray-100"><div>
      © Prashant Shrestha 2021
    </div> <a href="https://twitter.com/chivalryytf" target="_blank" class="h-6 w-6 ml-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current"><path d="M10 .4C4.698.4.4 4.698.4 10s4.298 9.6 9.6 9.6 9.6-4.298 9.6-9.6S15.302.4 10 .4zm3.905 7.864c.004.082.005.164.005.244 0 2.5-1.901 5.381-5.379 5.381a5.335 5.335 0 0 1-2.898-.85c.147.018.298.025.451.025.886 0 1.701-.301 2.348-.809a1.895 1.895 0 0 1-1.766-1.312 1.9 1.9 0 0 0 .853-.033 1.892 1.892 0 0 1-1.517-1.854v-.023c.255.141.547.227.857.237a1.89 1.89 0 0 1-.585-2.526 5.376 5.376 0 0 0 3.897 1.977 1.891 1.891 0 0 1 3.222-1.725 3.797 3.797 0 0 0 1.2-.459 1.9 1.9 0 0 1-.831 1.047 3.799 3.799 0 0 0 1.086-.299 3.834 3.834 0 0 1-.943.979z"></path></svg></a> <a href="https://github.com/chivalryytf" target="_blank" class="h-6 w-6 ml-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current"><path d="M10.015 9.949h-.03c-1.191 0-2.24-.303-2.861.268a1.57 1.57 0 0 0-.527 1.197c0 1.852 1.483 2.08 3.389 2.08h.029c1.905 0 3.389-.229 3.389-2.08 0-.443-.156-.856-.527-1.197-.622-.571-1.671-.268-2.862-.268zM8.393 12.48c-.363 0-.656-.408-.656-.91s.293-.908.656-.908c.363 0 .657.406.657.908.001.502-.293.91-.657.91zm3.213 0c-.363 0-.657-.408-.657-.91s.294-.908.657-.908c.362 0 .656.406.656.908.001.502-.293.91-.656.91zM10 .4C4.698.4.4 4.698.4 10s4.298 9.6 9.6 9.6 9.6-4.298 9.6-9.6S15.302.4 10 .4zm.876 13.539c-.172 0-.514 0-.876.002-.362-.002-.704-.002-.876-.002-.76 0-3.772-.059-3.772-3.689 0-.834.286-1.445.755-1.955-.074-.184-.078-1.232.32-2.236 0 0 .916.1 2.301 1.051.289-.081.781-.122 1.272-.122s.982.041 1.273.121c1.385-.951 2.301-1.051 2.301-1.051.398 1.004.395 2.053.32 2.236.469.51.755 1.121.755 1.955-.001 3.632-3.013 3.69-3.773 3.69z"></path></svg></a> <a href="https://www.linkedin.com/in/chivalryytf" target="_blank" class="h-6 w-6 ml-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current"><path d="M10 .4C4.698.4.4 4.698.4 10s4.298 9.6 9.6 9.6 9.6-4.298 9.6-9.6S15.302.4 10 .4zM7.65 13.979H5.706V7.723H7.65v6.256zm-.984-7.024c-.614 0-1.011-.435-1.011-.973 0-.549.409-.971 1.036-.971s1.011.422 1.023.971c0 .538-.396.973-1.048.973zm8.084 7.024h-1.944v-3.467c0-.807-.282-1.355-.985-1.355-.537 0-.856.371-.997.728-.052.127-.065.307-.065.486v3.607H8.814v-4.26c0-.781-.025-1.434-.051-1.996h1.689l.089.869h.039c.256-.408.883-1.01 1.932-1.01 1.279 0 2.238.857 2.238 2.699v3.699z"></path></svg></a> <a href="mailto:chivalryytf@gmail.com" target="_blank" class="h-6 w-6 ml-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current"><path d="M10 .4C4.698.4.4 4.698.4 10s4.298 9.6 9.6 9.6 9.6-4.298 9.6-9.6S15.302.4 10 .4zM6.231 7h7.52c.399 0 .193.512-.024.643-.217.13-3.22 1.947-3.333 2.014s-.257.1-.403.1a.793.793 0 0 1-.402-.1L6.255 7.643C6.038 7.512 5.833 7 6.231 7zM14 12.5c0 .21-.252.5-.444.5H6.444C6.252 13 6 12.71 6 12.5V8.853c0-.092-.002-.211.172-.11l3.417 2.015a.69.69 0 0 0 .402.1.69.69 0 0 0 .403-.1l3.434-2.014c.174-.102.172.018.172.11V12.5z"></path></svg></a></footer></div></div></div><script>window.__NUXT__={staticAssetsBase:"/_nuxt/static/1615999718",layout:"default",error:null,serverRendered:!0,routePath:"/blog/optimizing-and-resizing-images-using-canvas-api",config:{content:{dbHash:"fd77bf52"}}}</script><script src="/_nuxt/c4e5260.js" defer></script><script src="/_nuxt/caea6eb.js" defer></script><script src="/_nuxt/ee1435b.js" defer></script><script src="/_nuxt/e730602.js" defer></script><script src="/_nuxt/2b20522.js" defer></script>
  </body>
</html>
